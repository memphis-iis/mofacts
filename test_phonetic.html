<!DOCTYPE html>
<html>
<head>
    <title>Phonetic Conflict Test</title>
</head>
<body>
    <h1>Phonetic Conflict Test</h1>
    <pre id="output"></pre>

    <script type="module">
        // Import from jsdelivr which provides ES modules
        import { doubleMetaphone } from 'https://cdn.jsdelivr.net/npm/double-metaphone@2.0.0/+esm';

        // Test phonetic codes for country pairs that are causing issues
        const testPairs = [
            { correct: "cameroon", wrong: "comoros" },
            { correct: "guinea", wrong: "ghana" },
            { correct: "anguilla", wrong: "angola" },
            { correct: "akrotiri", wrong: "ecuador" },
            { correct: "mali", wrong: "malawi" },
            { correct: "mali", wrong: "molly" }
        ];

        let output = "=== PHONETIC CONFLICT TEST ===\n\n";

        testPairs.forEach(pair => {
            // Use doubleMetaphone
            const [correctP, correctS] = doubleMetaphone(pair.correct.toLowerCase());
            const [wrongP, wrongS] = doubleMetaphone(pair.wrong.toLowerCase());

            // Check if ANY codes match (current logic)
            const hasConflict =
                (correctP && (correctP === wrongP || correctP === wrongS)) ||
                (correctS && (correctS === wrongP || correctS === wrongS));

            output += `${pair.correct} vs ${pair.wrong}:\n`;
            output += `  ${pair.correct}: primary="${correctP}", secondary="${correctS || 'none'}"\n`;
            output += `  ${pair.wrong}: primary="${wrongP}", secondary="${wrongS || 'none'}"\n`;
            output += `  → Conflict: ${hasConflict ? "YES ✓ (will be removed)" : "NO ✗ (won't be removed)"}\n\n`;
        });

        output += "\n=== CONCLUSION ===\n";
        output += "If a pair shows 'NO ✗ (won't be removed)', that means Double Metaphone\n";
        output += "considers them phonetically DIFFERENT, so our current filtering logic\n";
        output += "won't catch them. We'll need a different approach (edit distance, etc.)\n";

        document.getElementById('output').textContent = output;
        console.log(output);
    </script>
</body>
</html>

{"version":3,"sources":["/tools/tool-env/install-babel.js"],"names":["babelRegister","meteorBabel","require","path","toolsPath","dirname","__dirname","meteorPath","cacheDir","join","babelOptions","getDefaultOptions","nodeMajorVersion","parseInt","process","versions","node","typescript","sourceMaps","setCacheDirectory","setSourceMapRootPath","allowDirectory","setBabelOptions","excludeFile","__filename"],"mappings":"AAAA;AACA;AAEA;;AAEA,SAASA,aAAT,GAAyB;AACvB,QAAMC,WAAW,GAAGC,OAAO,CAAC,iBAAD,CAA3B;;AACA,QAAMC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAApB;;AACA,QAAME,SAAS,GAAGD,IAAI,CAACE,OAAL,CAAaC,SAAb,CAAlB;AACA,QAAMC,UAAU,GAAGJ,IAAI,CAACE,OAAL,CAAaD,SAAb,CAAnB;AACA,QAAMI,QAAQ,GAAGL,IAAI,CAACM,IAAL,CAAUF,UAAV,EAAsB,cAAtB,CAAjB;AACA,QAAMG,YAAY,GAAGT,WAAW,CAACU,iBAAZ,CAA8B;AACjDC,IAAAA,gBAAgB,EAAEC,QAAQ,CAACC,OAAO,CAACC,QAAR,CAAiBC,IAAlB,CADuB;AAEjDC,IAAAA,UAAU,EAAE;AAFqC,GAA9B,CAArB,CANuB,CAWvB;AACA;;AACAP,EAAAA,YAAY,CAACQ,UAAb,GAA0B,QAA1B;;AAEAhB,EAAAA,OAAO,CAAC,0BAAD,CAAP,CACGiB,iBADH,CACqBX,QADrB,EAEGY,oBAFH,CAEwBb,UAFxB,EAGGc,cAHH,CAGkBjB,SAHlB,EAIGkB,eAJH,CAImBZ,YAJnB,EAKE;AACA;AANF,GAOGa,WAPH,CAOepB,IAAI,CAACM,IAAL,CAAUL,SAAV,EAAqB,UAArB,CAPf,EAQGmB,WARH,CAQepB,IAAI,CAACM,IAAL,CAAUH,SAAV,EAAqB,oBAArB,CARf,EASGiB,WATH,CASepB,IAAI,CAACM,IAAL,CAAUH,SAAV,EAAqB,gBAArB,CATf,EAUGiB,WAVH,CAUepB,IAAI,CAACM,IAAL,CAAUH,SAAV,EAAqB,kBAArB,CAVf,EAWGiB,WAXH,CAWepB,IAAI,CAACM,IAAL,CAAUL,SAAV,EAAqB,KAArB,EAA4B,4BAA5B,CAXf,EAYGmB,WAZH,CAYepB,IAAI,CAACM,IAAL,CAAUL,SAAV,EAAqB,KAArB,EAA4B,2BAA5B,CAZf,EAaGmB,WAbH,CAaepB,IAAI,CAACM,IAAL,CAAUL,SAAV,EAAqB,KAArB,EAA4B,qCAA5B,CAbf,EAcGmB,WAdH,CAcepB,IAAI,CAACM,IAAL,CAAUL,SAAV,EAAqB,KAArB,EAA4B,uBAA5B,CAdf,EAeGmB,WAfH,CAeeC,UAff;AAgBD,C,CAED;;;AACAtB,OAAO,CAAC,oBAAD,CAAP;;AAIAA,OAAO,CAAC,sBAAD,CAAP","sourcesContent":["// This file exists because it is the file in the tool that is not automatically\n// transpiled by Babel\n\n\"use strict\";\n\nfunction babelRegister() {\n  const meteorBabel = require(\"@meteorjs/babel\");\n  const path = require(\"path\");\n  const toolsPath = path.dirname(__dirname);\n  const meteorPath = path.dirname(toolsPath);\n  const cacheDir = path.join(meteorPath, \".babel-cache\");\n  const babelOptions = meteorBabel.getDefaultOptions({\n    nodeMajorVersion: parseInt(process.versions.node),\n    typescript: true\n  });\n\n  // Make sure that source maps are included in the generated code for\n  // meteor/tools modules.\n  babelOptions.sourceMaps = \"inline\";\n\n  require('@meteorjs/babel/register')\n    .setCacheDirectory(cacheDir)\n    .setSourceMapRootPath(meteorPath)\n    .allowDirectory(toolsPath)\n    .setBabelOptions(babelOptions)\n    // Exclude files that are imported before we configure\n    // meteor-babel/register (including this very file).\n    .excludeFile(path.join(toolsPath, \"index.js\"))\n    .excludeFile(path.join(__dirname, \"install-promise.js\"))\n    .excludeFile(path.join(__dirname, \"wrap-fibers.js\"))\n    .excludeFile(path.join(__dirname, \"install-reify.js\"))\n    .excludeFile(path.join(toolsPath, \"cli\", \"dev-bundle-bin-commands.js\"))\n    .excludeFile(path.join(toolsPath, \"cli\", \"dev-bundle-bin-helpers.js\"))\n    .excludeFile(path.join(toolsPath, \"cli\", \"flush-buffers-on-exit-in-windows.js\"))\n    .excludeFile(path.join(toolsPath, \"cli\", \"convert-to-os-path.js\"))\n    .excludeFile(__filename);\n}\n\n// Install reify first so babel falls back to it\nrequire('./install-reify.js');\n\n\n\nrequire(\"./install-runtime.js\");\n"],"file":"tools/tool-env/install-babel.js.map"}
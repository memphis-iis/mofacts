{"version":3,"sources":["/tools/isobuild/minifier-plugin.js"],"names":["_objectSpread","module","link","default","v","export","JsFile","CssFile","buildmessage","buildPluginModule","require","InputFile","constructor","source","options","_source","_arch","arch","_minifiedFiles","getContentsAsBuffer","contents","getPathInPackage","Error","getPackageName","getSourceHash","hash","getArch","error","message","sourcePath","line","column","func","relPath","getPathInBundle","file","undefined","targetPath","getSourceMap","sourceMap","addJavaScript","push","addStylesheet"],"mappings":"AAAA,IAAIA,aAAJ;;AAAkBC,MAAM,CAACC,IAAP,CAAY,sCAAZ,EAAmD;AAACC,EAAAA,OAAO,CAACC,CAAD,EAAG;AAACJ,IAAAA,aAAa,GAACI,CAAd;AAAgB;;AAA5B,CAAnD,EAAiF,CAAjF;AAAlBH,MAAM,CAACI,MAAP,CAAc;AAACC,EAAAA,MAAM,EAAC,MAAIA,MAAZ;AAAmBC,EAAAA,OAAO,EAAC,MAAIA;AAA/B,CAAd;AAAuD,IAAIC,YAAJ;AAAiBP,MAAM,CAACC,IAAP,CAAY,0BAAZ,EAAuC;AAACC,EAAAA,OAAO,CAACC,CAAD,EAAG;AAACI,IAAAA,YAAY,GAACJ,CAAb;AAAe;;AAA3B,CAAvC,EAAoE,CAApE;;AACxE,MAAMK,iBAAiB,GAAGC,OAAO,CAAC,mBAAD,CAAjC;;AAEA,MAAMC,SAAN,SAAwBF,iBAAiB,CAACE,SAA1C,CAAoD;AAClDC,EAAAA,WAAW,CAACC,MAAD,EAAuB;AAAA,QAAdC,OAAc,uEAAJ,EAAI;AAChC;AAEA,SAAKC,OAAL,GAAeF,MAAf;AACA,SAAKG,KAAL,GAAaF,OAAO,CAACG,IAArB;AACA,SAAKC,cAAL,GAAsB,EAAtB;AACD;;AAEDC,EAAAA,mBAAmB,GAAG;AACpB,WAAO,KAAKJ,OAAL,CAAaK,QAAb,EAAP;AACD;;AACDC,EAAAA,gBAAgB,GAAG;AACjB,UAAM,IAAIC,KAAJ,CAAU,4CAAV,CAAN;AACD;;AACDC,EAAAA,cAAc,GAAG;AACf,UAAM,IAAID,KAAJ,CAAU,4CAAV,CAAN;AACD;;AACDE,EAAAA,aAAa,GAAG;AACd,WAAO,KAAKT,OAAL,CAAaU,IAAb,EAAP;AACD;;AACDC,EAAAA,OAAO,GAAG;AACR,WAAO,KAAKV,KAAZ;AACD;;AAEDW,EAAAA,KAAK,OAA4C;AAAA,QAA3C;AAACC,MAAAA,OAAD;AAAUC,MAAAA,UAAV;AAAsBC,MAAAA,IAAtB;AAA4BC,MAAAA,MAA5B;AAAoCC,MAAAA;AAApC,KAA2C;AAC/C,UAAMC,OAAO,GAAG,KAAKC,eAAL,EAAhB;AACA1B,IAAAA,YAAY,CAACmB,KAAb,CAAmBC,OAAO,IAAK,qBAAqBK,OAApD,EAA8D;AAC5DE,MAAAA,IAAI,EAAEN,UAAU,IAAII,OADwC;AAE5DH,MAAAA,IAAI,EAAEA,IAAI,GAAGA,IAAH,GAAUM,SAFwC;AAG5DL,MAAAA,MAAM,EAAEA,MAAM,GAAGA,MAAH,GAAYK,SAHkC;AAI5DJ,MAAAA,IAAI,EAAEA,IAAI,GAAGA,IAAH,GAAUI;AAJwC,KAA9D;AAMD;AAED;AACF;AACA;AACA;AACA;;;AACEF,EAAAA,eAAe,GAAG;AAChB,WAAO,KAAKnB,OAAL,CAAasB,UAApB;AACD;AAED;AACF;AACA;AACA;AACA;;;AACEC,EAAAA,YAAY,GAAG;AACb,WAAO,KAAKvB,OAAL,CAAawB,SAApB;AACD;;AAnDiD;;AAsD7C,MAAMjC,MAAN,SAAqBK,SAArB,CAA+B;AACpC;AACA;AACA;AACA;AACA;AACA6B,EAAAA,aAAa,CAAC1B,OAAD,EAAU;AACrB,SAAKI,cAAL,CAAoBuB,IAApB,mBAA8B3B,OAA9B;AACD;;AARmC;;AAW/B,MAAMP,OAAN,SAAsBI,SAAtB,CAAgC;AACrC;AACA;AACA;AACA;AACA;AACA+B,EAAAA,aAAa,CAAC5B,OAAD,EAAU;AACrB,SAAKI,cAAL,CAAoBuB,IAApB,mBAA8B3B,OAA9B;AACD;;AARoC","sourcesContent":["import buildmessage from '../utils/buildmessage.js';\nconst buildPluginModule = require('./build-plugin.js');\n\nclass InputFile extends buildPluginModule.InputFile {\n  constructor(source, options = {}) {\n    super();\n\n    this._source = source;\n    this._arch = options.arch;\n    this._minifiedFiles = [];\n  }\n\n  getContentsAsBuffer() {\n    return this._source.contents();\n  }\n  getPathInPackage() {\n    throw new Error(\"Compiled files don't belong to any package\");\n  }\n  getPackageName() {\n    throw new Error(\"Compiled files don't belong to any package\");\n  }\n  getSourceHash() {\n    return this._source.hash();\n  }\n  getArch() {\n    return this._arch;\n  }\n\n  error({message, sourcePath, line, column, func}) {\n    const relPath = this.getPathInBundle();\n    buildmessage.error(message || ('error minifying ' + relPath), {\n      file: sourcePath || relPath,\n      line: line ? line : undefined,\n      column: column ? column : undefined,\n      func: func ? func : undefined\n    });\n  }\n\n  /**\n   * @summary Returns the path of the compiled file in the bundle.\n   * @memberof InputFile\n   * @returns {String}\n   */\n  getPathInBundle() {\n    return this._source.targetPath;\n  }\n\n  /**\n   * @summary Returns the source-map associated with the file.\n   * @memberof InputFile\n   * @returns {String}\n   */\n  getSourceMap() {\n    return this._source.sourceMap;\n  }\n}\n\nexport class JsFile extends InputFile {\n  // - data\n  // - sourceMap\n  // - path\n  // - hash?\n  // - stats?\n  addJavaScript(options) {\n    this._minifiedFiles.push({ ...options });\n  }\n}\n\nexport class CssFile extends InputFile {\n  // - data\n  // - sourceMap\n  // - path\n  // - hash?\n  // - stats?\n  addStylesheet(options) {\n    this._minifiedFiles.push({ ...options });\n  }\n}\n\n"],"file":"tools/isobuild/minifier-plugin.js.map"}
<!-- Content (TDF and Stim) File Uploading Template -->

<template name="contentUpload">
    <div class="container-fluid" style="padding: 0% 10%;">
        {{#if isInRole 'admin,teacher'}}
            <div class="row">
                <h1 class="text-center">Asset Uploader</h1>
                <p>This uploads your assets for use in experiments. It will upload packaged zip files with TDF/stim/asset combinations. Your package can also include image, video, and sound files. A link will be generated and available after upload. Note, it may take some time to complete large packages. Please wait until a prompt is given to navigate to a new page.</p>   
            </div>
        {{else}}
        <h2>You do not have access to this function.</h2>
        {{/if}}
        <br>
        <div class="row"> 
            <div class="col-md-4">
                <legend class="text-center">Upload ZIP Package</legend>
                <div class="form-group">
                    <span class="btn btn-default btn-file">
                        Browse ZIP Package
                        <input id="upload-package" style="margin: auto; display:block;" type="file" multiple />
                        <span class='label label-info file-info' id="package-file-info"></span>
                    </span>
                </div>
                <button type='button' id='doUploadPackage' class='btn btn-fix'>
                    Upload ZIP Package
                </button>
            </div>
            </div>
            <div class="row">
            <div class="col-md-12 table-responsive">
                <legend class="text-center">Your Uploaded Files</legend>
                <p>*Deleting a stim will delete the corresponding TDF and all related history. Deleting is not recoverable.</p>

                <p><span class="fa fa-download" aria-hidden="true"></span>Download<br><span class="fa fa-share" aria-hidden="true"></span>Export</p>
            
                <table class="table table-striped table-bordered table-condensed">
                    <thead>
                        <tr>
                            <th class="col-md-1">Type</th>
                            <th class="col-md-6">Name</th>
                            <th class="col-md-1">Download</th>
                            <th class="col-md-1">Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each TdfFiles}}
                            <tr>
                                <td>tdf</td>
                                <td>{{content.fileName}}</td>
                                <td><button id="tdf-download-btn" value="{{_id}}" class="btn"><span class="fa fa-download" aria-hidden="true"></span></button></td>
                                <td><button id="tdf-delete-btn" value="{{_id}}" data-filename="{{fileName}}" class="btn"><span class="fa fa-minus" aria-hidden="true"></span></button></td>
                            </tr>
                        {{/each}}
                        {{#each StimFiles}}
                            <tr>
                                <td>stim</td>
                                <td>{{this.fileName}}</td>
                                <td><button id="stim-download-btn" value="{{stimuliSetId}}" class="btn"><span class="fa fa-download" aria-hidden="true"></span></button></td>
                                <td><button id="stim-delete-btn" value="{{stimuliSetId}}" data-filename="{{fileName}}" class="btn"><span class="fa fa-minus" aria-hidden="true"></span></button></td>
                            </tr>
                        {{/each}}
                        {{#each assets}}
                            <tr>
                                <td>
                                    {{ext}}
                                </td>
                                <td>
                                    {{name}}
                                </td>
                                <td>
                                    <a href="{{link}}" download="{{name}}" target="_parent">
                                        <button id="assetDownloadButton" value="{{_id}}" class="btn"><span class="fa fa-download" aria-hidden="true"></span></button>
                                    </a>
                                </td>
                                <td><button id="assetDeleteButton" value="{{_id}}" data-id="{{_id}}" class="btn"><span class="fa fa-minus" aria-hidden="true"></span></button></td>
                            </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </div>

        {{#if isInRole 'admin'}}
            <h2>Admin Functions</h2>
            <p>
                <button class="btn btn-danger" id="deleteAllAssetsPrompt">Delete All Assets. This is NOT recoverable.</button>
                <button class="btn btn-danger" style="display: none;" id="deleteAllAssetsConfirm" hidden>Are you sure? This is NOT recoverable.</button>
            </p>
        {{/if}}
    </div>
</template>

<!-- User Administration Template -->

<template name="adminControls">
    {{#if isInRole 'admin'}}
        <div class="container" style="margin-top: 1rem;">
            <h3 style="margin-top: 0; text-align: center;">Admin Control Panel</h3>

            <div class="admin-section" style="margin-top: 0;">
                <div class="row text-center">
                    <h4>Server Status</h4>
                </div>
                <div class="row row-cols-2">
                    <div class="col text-end">
                        Server Storage Space 
                    </div>
                    <div class="col">
                        <!-- boostrap progress bar-->
                        <div class="progress">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow={{serverStatus.diskSpacePercent}} aria-valuemin="0" aria-valuemax="100" style="width: {{serverStatus.diskSpacePercent}}%"></div>
                        </div>  
                    </div>
                </div>
                <div class="row row-cols-2">
                    <div class="col text-end">
                        Server Storage Space (Text)
                    </div>
                    <div class="col">
                        Used {{serverStatus.diskSpacePercent}}%, Remaining ({{serverStatus.remainingSpace}}/{{serverStatus.diskSpace}} GB)
                    </div>
                </div>
            </div>

            <div class="admin-section">
                <div class="row text-center">
                    <h4>Theme</h4>
                </div>
                {{#if currentTheme.enabled}}
                <div class="row">
                    <!-- warning of unsaved changes-->
                    <div class="alert alert-warning vertical-center mb-4" role="alert" id="unsavedThemeChanges" hidden>
                        <h4 class="alert-heading">Unsaved Changes</h4>
                    </div>
                    <button type="button" id="themeSaveButton" class="btn btn-fixed">Save Custom Theme</button>
                </div>
                <div class="row row-cols-2">
                    <div class="col text-end">
                        <button type="button" id="themeInitButton" class="btn btn-fixed">Disable Custom Theme</button>
                    </div>
                    <div class="col">
                        <button type="button" id="themeResetButton" class="btn btn-fixed">Reset Custom Theme</button>
                    </div>
                    <div class="col text-end">
                        Theme Name:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.themeName}}" data-id="themeName">    
                    </div>
                    <div class="col text-end">
                        Background Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.background_color}}" data-id="background_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.background_color}}" data-id="background_color">
                    </div>
                    <div class="col text-end">
                        Navigation Text Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.navbar_text_color}}" data-id="navbar_text_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.navbar_text_color}}" data-id="navbar_text_color">
                    </div>
                    <div class="col text-end">
                        Accent Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.accent_color}}" data-id="accent_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.accent_color}}" data-id="accent_color">
                    </div>
                    <div class="col text-end">
                        Primary Button Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.button_color}}" data-id="button_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.button_color}}" data-id="button_color">
                    </div>
                    <div class="col text-end">
                        Button Hover Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.success_color}}" data-id="success_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.success_color}}" data-id="success_color">
                    </div>
                    <div class="col text-end">
                        Primary Button Text Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.primary_button_text_color}}" data-id="primary_button_text_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.primary_button_text_color}}" data-id="primary_button_text_color">
                    </div>
                    <div class="col text-end">
                        Secondary Button and Menu Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.secondary_color}}" data-id="secondary_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.secondary_color}}" data-id="secondary_color">
                    </div>
                    <div class="col text-end">
                        Secondary Button Text and Menu Item Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.secondary_text_color}}" data-id="secondary_text_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.secondary_text_color}}" data-id="secondary_text_color">
                    </div>
                    <div class="col text-end">
                        Alert Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.alert_color}}" data-id="alert_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.alert_color}}" data-id="alert_color">  
                    </div>
                    <div class="col text-end">
                        Body Text Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.text_color}}" data-id="text_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.text_color}}" data-id="text_color">
                    </div>
                    <div class="col text-end">
                        Audio Alert Color
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.audio_alert_color}}" data-id="audio_alert_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.audio_alert_color}}" data-id="audio_alert_color">
                    </div>
                    <div class="col text-end">
                        Top Bar / Neutral Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.neutral_color}}" data-id="neutral_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.neutral_color}}" data-id="neutral_color">
                    </div>
                    <div class="col text-end">
                        Navbar Text Color:
                    </div>
                    <div class="col">
                        <input type="text" class="currentThemeProp" value="{{currentTheme.properties.navbar_text_color}}" data-id="navbar_text_color">
                        <input type="color" class="currentThemePropColor" value="{{currentTheme.properties.navbar_text_color}}" data-id="navbar_text_color">
                    </div>
                    <div class="col text-end">
                        Transition Speed - Instant (ms):
                    </div>
                    <div class="col">
                        <input type="number" class="currentThemeProp form-control" value="{{currentTheme.properties.transition_instant}}" data-id="transition_instant" min="0" max="500" step="10" placeholder="10">
                        <small class="form-text text-muted">
                            <strong>Default: 10ms</strong> - Near-instant (accessibility fallback, reduced motion mode)
                        </small>
                    </div>
                    <div class="col text-end">
                        Transition Speed - Fast (ms):
                    </div>
                    <div class="col">
                        <input type="number" class="currentThemeProp form-control" value="{{currentTheme.properties.transition_fast}}" data-id="transition_fast" min="0" max="500" step="10" placeholder="100">
                        <small class="form-text text-muted">
                            <strong>Default: 100ms</strong> - Quick transitions<br>
                            <em>Used for:</em> Buttons, hovers, input fields, progress bars, countdown timers, feedback displays
                        </small>
                    </div>
                    <div class="col text-end">
                        Transition Speed - Smooth (ms):
                    </div>
                    <div class="col">
                        <input type="number" class="currentThemeProp form-control" value="{{currentTheme.properties.transition_smooth}}" data-id="transition_smooth" min="0" max="1000" step="50" placeholder="200">
                        <small class="form-text text-muted">
                            <strong>Default: 200ms</strong> - Main content transitions<br>
                            <em>Used for:</em> Trial card fades, modal animations, major content changes
                        </small>
                    </div>
                    <div class="col text-end">

                        Logo:
                    </div>
                    <div class="col">
                        <input type="file" class="form-control" id="logoUpload" accept="image/*">
                        {{#if currentTheme.properties.logo_url}}
                        <button type="button" id="clearLogo" class="btn btn-secondary btn-sm" style="margin-top: 0.5rem;">Clear Logo</button>
                        <div style="margin-top: 0.5rem;">
                            <img src="{{currentTheme.properties.logo_url}}" alt="Logo preview" class="img-thumbnail" style="max-width: 200px;">
                        </div>
                        {{/if}}
                    </div>
                </div>
                <div class="row row-cols-2">
                    <div class="col text-end">
                        Sign In Description:
                    </div>
                    <div class="col">
                        <textarea class="form-control currentThemeProp" rows="3" data-id="signInDescription">{{currentTheme.properties.signInDescription}}</textarea>
                    </div>
                </div>
                {{else}}
                <div class="row">    
                    <div class="col text-center">
                        <button type="button" id="themeInitButton" class="btn btn-fixed">Enable Custom Theme</button>
                    </div>
                </div>
                {{/if}}
            </div>

            <div class="admin-section">
                <div class="row text-center">
                    <h4>Custom Help Page</h4>
                </div>
                <div class="row mt-3">
                    <div class="col-12">
                        <p class="text-center">
                            Upload a custom markdown (.md) file to replace the default wiki help page.
                            Students will see your custom content instead of the GitHub wiki.
                        </p>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6 offset-md-3">
                        <div class="mb-3">
                            <label for="helpFileUpload" class="form-label">Choose Markdown File (.md)</label>
                            <input type="file" class="form-control" id="helpFileUpload" accept=".md">
                            <div class="form-text">Maximum file size: 1MB</div>
                        </div>
                    </div>
                </div>
                {{#if customHelpPageEnabled}}
                <div class="row mt-2">
                    <div class="col text-center">
                        <div class="alert alert-info d-inline-block mb-0 py-2 px-4">
                            <strong>Custom help page is active</strong>
                            {{#if customHelpPageUploadedAt}}
                            <br>
                            <small>Uploaded: {{formatDate customHelpPageUploadedAt}}</small>
                            {{/if}}
                        </div>
                    </div>
                </div>
                {{/if}}
                <div class="row mt-2">
                    <div class="col text-center">
                        <button type="button" id="uploadHelpFileButton" class="btn btn-fixed btn-primary">
                            Upload Custom Help File
                        </button>
                        {{#if customHelpPageEnabled}}
                        <button type="button" id="removeHelpFileButton" class="btn btn-fixed btn-danger ms-2">
                            Remove Custom Help & Use Wiki
                        </button>
                        {{/if}}
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-12 text-center">
                        <span id="helpFileUploadStatus" class="text-muted"></span>
                    </div>
                </div>
            </div>

            <div class="admin-section">
                <div class="row text-center">
                    <h4>Test Logins</h4>
                </div>
                <form>
                    <div class="row row-cols-2">
                        <div class="col text-end">
                            <label class="form-check-label" for="verbosityRadio1">
                                Test Logins Enabled
                            </label>
                        </div>
                        <div class="col">
                            <input type="checkbox" class="form-check-input" id="testLoginsCheckbox">
                            {{#if testLoginsEnabled}}
                                <br>
                                Please logout and navigate to /testlogin to login as a test user.
                                <br>
                                You may also use /testlogin?username=testusername to login as a specific user.
                            {{/if}}
                        </div>
                    </div>
                </form>
            </div>

            <div class="admin-section">
                <div class="row text-center">
                    <h4>Update stimDisplayTypeMap</h4>
                </div>
                <div class="row">    
                    <div class="col text-center">
                        <button type="button" id="updateStimDisplayTypeMap" class="btn btn-fixed">Clear</button>
                    </div>
                </div>
            </div>

            <div class="admin-section">
                <div class="row text-center">
                    <h4>Verbosity Level</h4>
                </div>
                <form>
                    <div class="row row-cols-2">
                        <div class="col text-end">
                            <label class="form-check-label" for="verbosityRadio1">
                                Server Logs Only
                            </label>
                        </div>
                        <div class="col">
                            <input  type="radio" name="flexRadioDefault" id="verbosityRadio0">
                        </div>
                        <div class="col text-end">
                            <label class="form-check-label" for="verbosityRadio1">
                                Function Times Only
                            </label>
                        </div>
                        <div class="col">
                            <input  type="radio" name="flexRadioDefault" id="verbosityRadio1">
                        </div>
                        <div class="col text-end">
                            <label class="form-check-label" for="verbosityRadio2">
                                Server Logs and Function Times
                            </label>
                        </div>
                        <div class="col">
                            <input  type="radio" name="flexRadioDefault" id="verbosityRadio2">
                        </div>
                    </div>
                </form>
            </div>
        </div>

    {{/if}}

    <div class="admin-section">
        <div class="row text-center">
            <h4>Client Verboisty Level</h4>
        </div>
        <form>
            <div class="row row-cols-2">
                <div class="col text-end">
                    <label class="form-check-label" for="clientVerbosityRadio0">
                        No Logging (fastest)
                    </label>
                </div>
                <div class="col">
                    <input class="clientVerbosityRadio" type="radio" name="flexRadioDefault" id="clientVerbosityRadio0">
                </div>
                <div class="col text-end">
                    <label class="form-check-label" for="clientVerbosityRadio1">
                        Function Calls Only (slower)
                    </label>
                </div>
                <div class="col">
                    <input class="clientVerbosityRadio" type="radio" name="flexRadioDefault" id="clientVerbosityRadio1">
                </div>
                <div class="col text-end">
                    <label class="form-check-label" for="clientVerbosityRadio2">
                        Full Logging (slowest)
                    </label>
                </div>
                <div class="col">
                    <input class="clientVerbosityRadio" type="radio" name="flexRadioDefault" id="clientVerbosityRadio2">
                </div>
            </div>
        </form>
    </div>
</template>
    
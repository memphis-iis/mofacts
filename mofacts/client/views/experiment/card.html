<template name="card">
    <div class="container position-relative my-20">
        {{#if isVideoSession}}
        <div class="row my-5">
            <div class="col-lg-12 visible-text text-center">
                {{{videoUnitDisplayText}}}
            </div>
        </div>
        <div class="container position-relative">
            {{#if isYoutubeVideo}}
                <div id="videoUnitContainer" class="z-0 w-100">
                    <div id="videoUnitPlayer" data-plyr-provider="youtube" data-plyr-embed-id="{{videoId}}"></div>
                    </div> 
                    <div class="row">
                        <dov class="col-6 offset-3">
                            <div id="continueBar" hidden style="text-align: center; padding: 20px">
                                <button type="button" id="continueButton" class="btn text-center">
                                    {{UIsettings.continueButtonText}}
                                </button>
                            </div> 
                        </dov>
                        {{#if allowGoBack}}
                        <div class="col-1 offset-2">
                            <div id="goBackBar" style="text-align: center; padding: 20px">
                                <button type="button" id="stepBackButton" class="btn text-center">
                                    <!-- back icon -->
                                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                                </button>
                            </div> 
                        </div>
                        {{/if}}
                </div>
            {{else}}
                <div id="videoUnitContainer" class="position-absolute z-0 w-100">
                    <video id="videoUnitPlayer" playsinline controls>
                        <source src="{{videoSource}}" type="video/mp4" />
                    </video>
                    <div class="row">
                        <dov class="col-6 offset-3">
                            <div id="continueBar" hidden style="text-align: center; padding: 20px">
                                <button type="button" id="continueButton" class="btn text-center">
                                    {{UIsettings.continueButtonText}}
                                </button>
                            </div> 
                        </dov>
                        {{#if allowGoBack}}
                        <div class="col-1 offset-2">
                            <div id="goBackBar" style="text-align: center; padding: 20px">
                                <button type="button" id="stepBackButton" class="btn text-center">
                                    <!-- back icon -->
                                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                                </button>
                            </div> 
                        </div>
                        {{/if}}
                    </div> 
                </div>
            {{/if}}
        </div>
        {{#if isVideoSession}}
        {{else}}
        <div class="vh-100"></div>
        {{/if}}
        {{/if}}
        <br>
        {{#if isImpersonating}}
        <div class='text-center alert alert-warning'>
                Impersonation Mode. Nothing will be logged. Log out to reset.
        </div>
        {{/if}}
        {{#if displayFeedback}}
        {{>profileDialogueToggles}}
        <div>
            <br />
            {{#if resetFeedbackSettingsFromIndex}}
                <button id='confirmFeedbackSelectionFromIndex' class='btn width-100-percent'>Confirm feedback settings</button>
            {{else}}
                <button id='confirmFeedbackSelection' class='btn width-100-percent'>Confirm feedback settings</button>
            {{/if}}
        </div>
    {{/if}}
        {{#if displayReady}}
        <div id="userInteractionContainer" class="vh-5" hidden>
                <div class="text-center {{fontSizeClass}}" id="UserInteraction" style="margin-top: 0px;" hidden></div>
                <div class="" id="forceCorrectionEntry" hidden>
                    {{> inputForceCorrect}}
                </div>
                <div class="vh-10"></div>
        </div>
        <br>    

            <div class="scrollHistoryContainer">
                {{#if haveScrollList}}
                {{#each scrollList}}
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-8 col-lg-12">
                        <div class="panel">
                            <div class="panel-heading bg-primary">{{question}}</div>
                            <div class="panel-body {{#if userCorrect}}bg-success{{/if}} {{#unless userCorrect}}bg-danger{{/unless}}">{{answer}}</div>
                        </div>
                    </div>
                </div>
                {{/each}}
                {{/if}}
            </div>
            <div class="row{{UIsettings.reverseStimuliAndInputColumns}} mx-auto w-100 top-0 {{#if isVideoSession}}questionContainer position-absolute z-1{{/if}}">
                {{#if trial}}
                <div class="{{UIsettings.displayColWidth}} mx-auto" id="displayContainer">
                    {{#if anythingButAudioCard}}
                        <div class="{{fontSizeClass}} {{#if study}} {{UIsettings.textInputDisplay}} {{/if}} alert {{#if UIsettings.showStimuliBox}}{{#if UIsettings.stimuliBoxColor}}{{UIsettings.stimuliBoxColor}}{{else}}alert-bg{{/if}}{{else}}alert-transparent{{/if}}" id="displaySubContainer">
                            <p style="{{getFontSizeStyle}}">
                            {{#if ifClozeDisplayTextExists}}
                                {{#if textOrClozeCard}}
                                    {{#if subWordClozeCurrentQuestionExists}}
                                        {{{subWordParts}}}
                                    {{else}}
                                        {{{clozeText}}}
                                        {{{text}}}
                                    {{/if}}
                                {{/if}}
                            {{/if}}
                            </p>
                            {{#if imageCard}}
                            <div class="h2 vh-50" id="imageDisplay">
                                <div class="w-100 imgDisplay-container text-center" style="background-image: url({{curImgSrc}}) ;">
                                </div>
                                <br>
                            </div>
                            {{/if}}
                            {{#if videoCard}}
                                <video autoplay="">
                                    <source src="{{curVideoSrc}}">
                                    Your browser does not support the video tag.
                                </video>
                            {{/if}}
                    {{/if}}
                    {{#if audioCard}}
                        
                        <!-- fa speaker icon with class img-responsive-->
                        <div class="text-center">
                            <span class="fa fa-volume-up fa-5x" id="audioIcon"></span>
                        </div>
                        <div class="vh-5"></div>
                    {{/if}}
                </div>
                <div id="correctAnswerDisplayContainer" class="{{UIsettings.textInputDisplay2}} alert {{fontSizeClass}} {{UIsettings.displayColWidth}} d-none text-center">
                </div>         
                <div id="feedbackOverrideContainer" hidden>
                    <div id="feedbackOverride" class="{{fontSizeClass}} text-center">
                        
                    </div>
                </div>
                {{#if userInDiaglogue}}   
                    <div class="row {{fontSizeClass}}">
                        <div class="container-fluid" id="displayContainer">
                            <div id="leftPanel" class="col-md-11">
                                <div class="alert text-center" id="textQuestion">
                                    {{{dialogueText}}}
                                </div>
                            </div>
                        </div>
                    </div>
                {{/if}}
            {{/if}}

            {{#if skipstudy}}
            <div class="col-12 text-center">
                <button type='button' id='continueStudy' name='continueStudy' class='btn btn-block btn-responsive'>
                    {{UIsettings.skipStudyButtonText}}
                </button>
            </div>
            <div class="vh-5"></div>
            {{/if}}

            {{#if study}}
                <div class="alert {{UIsettings.displayColWidth}} {{fontSizeClass}} {{UIsettings.textInputDisplay2}} ">
                    {{#if hideResponse}}
                        <p id="answerLabel" class="answer-display-trial text-center" style="{{getFontSizeStyle}}">{{displayAnswer}}</p>
                    {{/if}}
                </div>  <!-- close column -->
            {{/if}}

            {{#if testordrill}}
                {{#if audioEnabled}}
                    {{#if isNotInDialogueLoopStageIntroOrExit}}
                        <p class="marginLeftAndRight text-center">{{voiceTranscriptionPromptMsg}}</p>
                        <img class="center-block" style="height:50px; width:auto; " src="{{voiceTranscriptionImgSrc}}">
                        <br>
                    {{/if}}
                {{/if}}
                {{#if notButtonTrialOrInDialogueLoop}}
                        <div class="input-box col-12" style="box-sizing: border-box;">
                            {{#if showDialogueHints}}
                                {{#if dialogueCacheHint}}
                                    <div class="row hints">
                                        <div class="col-lg-12 visible-text text-center">
                                            <b>Hints:</b> {{dialogueCacheHint}}
                                        </div>
                                    </div>
                                {{/if}}
                            {{/if}}
                            {{> inputF}}
                        </div>
                {{else}}
                    
                    
                
                {{#if buttonTrial}}
                    {{#if audioEnabled}}
                        <p class="marginLeftAndRight text-center">Please speak the letter next to the correct option for audio input</p>
                    {{/if}}
                {{/if}}
            
                <div id="multipleChoiceContainer" class="{{UIsettings.choiceColWidth}} {{#if isVideoSession}} max-vh-30 overflow-scroll {{/if}}">
                    <!-- will contain multiple choice buttons which are dynamically added. -->
                    {{#if buttonTrial}}
                    <div id="multipleChoiceTable" class="row gy-3 choice text-center row-cols-{{UIsettings.choiceButtonCols}} align-items-start">
                        {{#if imageResponse}}
                            {{#each buttonListImageRows}}
                            <div class="col ml-auto">
                                {{#each this}}
                                {{#if audioEnabled}}
                                    <label style="margin-bottom:0px">{{verbalChoice}}.</label>
                                    <br>
                        
                                {{/if}}
                        
                                    <button style="background: url({{buttonValue}});background-size: 300px 150px;;background-repeat: no-repeat;" verbalChoice='{{verbalChoice}}' type='button' name='{{buttonName}}' class='btnPaddedAndMinWidth btn-alt btn-block multipleChoiceButton btn-image btn-responsive'>
                                    </button>
                                
                                {{/each}}
                            </div>
                            {{/each}}
                        {{else}}
                            {{#each buttonList}}
                            <div display={{displayReadyConverter (displayReady) }} class="col ml-auto">
                                {{#if audioEnabled}}
                                <label style="margin-bottom:0px">{{verbalChoice}}.</label>
                                <br>
                                {{/if}}
                            
                                <button verbalChoice='{{verbalChoice}}' type='button' name='{{buttonName}}' class='multipleChoiceButton btn btn-primary'>
                                {{{buttonValue}}}
                                </button>
                            
                            </div>
                            {{/each}}
                        {{/if}}
                    </div>
                    {{/if}}
                <br>
            </div>
            {{/if}}

            {{#if UIsettings.displayConfirmButton}}
            <div class="col-12 text-center">
                <button type='button' id='confirmButton' name='confirmButton' class='btn btn-block btn-responsive' disabled>
                    {{UIsettings.continueButtonText}}
                </button>
            </div>
            {{/if}}

            {{/if}}
            {{#if questionIsRemovable}}
            <div class="vh-10"></div>
                <div class="removalContainer">
                    <div class="col-sm-12 col-xs-12 col-md-6 col-lg-6 mx-auto text-center">
                        <button href="#" id="removeQuestion" class="btn btn-secondary">
                            Report Mistake
                        </button> 
                    </div>
                </div>
            {{/if}}
            </div>
            


            {{#if isInRole 'teacher'}}
            <div class="row">
                <div class="col-lg-12 visible-text text-center">
                    {{#if displayAnswer}}<h5>Teacher Aid (Answer): {{displayAnswer}}</h5>{{/if}}
                    {{#if currentProgress}}<h5>Current Progress: {{currentProgress}}</h5>{{/if}}
                    {{#if rawAnswer}}<h5>Teacher Aid (Raw Answer Text): {{rawAnswer}}</h5>{{/if}}
                </div>
            </div>
            {{/if}}
            {{#if isInRole 'admin'}}
                {{#if debugParms.probParmsDisplay}}            
                <div class="col-lg-12 visible-text text-left">
                    {{#if probabilityParameters}}
                    <h5>(Debug) Probabilty input parameters for this selection:</h5>
                        <p style="font-size: small;">
                                {{#each probabilityParameters}}
                                {{this.parameter}}: {{this.value}}, &nbsp;
                                {{/each}}
                        </p>
                    {{else}}
                        <h5>(Debug) No probability input parameters for this selection due to being a resumed session.</h5>
                    {{/if}}
                </div>
                {{/if}}
            {{/if}}
            <div class="row">
                <div hidden  class="col-lg-offset-2 col-lg-5" style="text-align: center;" id="overlearningRow">
                    <h4 style=" color: #585858;">You are currently overlearning!  Please consider taking a break and coming back later.</h4>
                    <button id="overlearningButton" type="button" class="btn btn-responsive" style="width: auto;">Practice</button>
                </div>
            </div>
        {{/if}}
    {{#if displayReadyPromptString}}
        <div class="marginLeftAndRight alert alert-info {{fontSizeClass}} text-center" id="textQuestion">
            {{readyPromptString}}
        </div>
    {{/if}}

        <!-- Modal -->
        <div class="modal fade" id="finalInstructionsDlg" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header visible-text">
                        <button type="button" class="close instructModalDismiss" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Good Bye</h4>
                    </div>
                    <div class="modal-body visible-text">
                        <div id="finalInstructionsText"></div>
                    </div>
                    <div class="modal-footer visible-text">
                        <button type="button" class="btn btn-default btn-responsive instructModalDismiss" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="lastUnitModal" tabindex="-1" role="dialog" aria-labelledby="lastUnitModal" aria-hidden="true" data-backdrop="static">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header visible-text">
                        <h4 class="modal-title" id="lastUnitModal"></h4>
                    </div>
                    <div class="modal-body visible-text">
                        <div id="lastUnitModalText">This is the last video, do not progress unless finished with this lesson.</div>
                    </div>
                    <div class="modal-footer visible-text">
                        <button type="button" id="lastUnitModalDismiss" class="btn btn-default btn-responsive" data-bs-dismiss="modal">Continue</button>
                    </div>
                </div>
            </div>
        </div>

    </div> <!-- close container -->

    <div id="postCardContainer">&nbsp;</div>


    <!-- Use a fixed footer if we have something to show -->
    {{#if haveDispTimeout}}
    <div id="continueBar" >
        <span id="displayTimeoutMsg">
            <!-- timer bar -->
            <div class="progress">
                <div id="timerBar" class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="{{displayTimeout}}" style="width: 0%">
                    <span class="sr-only">0% Complete</span>
                </div>
            </div>
        </span>
        <div class="row">
            <div class="col-6 offset-3">
                <button type="button" id="continueButton" class="btn text-center">
                    {{UIsettings.continueButtonText}}
                </button>
            </div>    
            {{#if allowGoBack}}
            <div class="col-1 offset-2">
                <button type="button" id="stepBackButton" class="btn text-center">
                    <!-- back icon -->
                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                </button>
            </div>
            {{/if}}
        </div>
    </div> 
    {{/if}}
    <!-- card lower feedback-->
  {{#if isInTrial}}
  {{#if isInInstructions}}
  {{else}}
  <div id="userLowerInteractionContainer">
      <div class="row text-center">
          <div class="col-sm-12 col-xs-12 col-md-6 col-lg-6 mx-auto" style="margin-bottom: 30px;">
              <br>
              <div id="userLowerInteraction">
              </div>
              <div id="CountdownTimerText">
              </div>
              <div id="progressBarContainer" class="progress">
                  <div id="progressbar" class="bg-warning progress-bar-striped" role="progressbar" aria-label="Basic example" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width:0%;"></div>
              </div>
          </div>
      </div>
  </div>
  {{/if}}
{{/if}}

</template>
